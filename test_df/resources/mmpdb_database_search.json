{"executorId":0,"id":"c3f72343-2aa9-4555-9b05-8d9b4b8b8925","dataFxnDefId":"8a684464-212f-4aa1-8be8-ec0628803f5a","serviceName":"MmpdbDatabaseSearch","assembly":null,"inputFields":{"queryData":{"id":"queryData","dataType":"string","contentType":"chemical/x-mdl-molfile","selectorType":null,"data":"ACS Document 1996\r\n  ChemDraw04082213572D\r\n\r\n 27 29  0  0  0  0  0  0  0  0999 V2000\r\n    5.3325    1.9743    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    4.5121    2.0606    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\r\n    4.0271    1.3931    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    4.3627    0.6395    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\r\n    3.2067    1.4794    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    2.7942    2.1938    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    1.9872    2.0223    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\r\n    1.9010    1.2018    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    2.6546    0.8663    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0\r\n    1.1865    0.7893    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\r\n    1.1865   -0.0357    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    0.4720   -0.4482    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -0.2425   -0.0357    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -0.2425    0.7893    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n    0.4720    1.2018    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -0.9569   -0.4482    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -1.6714   -0.0357    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -1.6714    0.7893    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -2.3859   -0.4482    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -2.4721   -1.2686    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -3.2791   -1.4402    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -3.6916   -0.7257    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -3.1395   -0.1126    0.0000 N   0  0  0  2  0  0  0  0  0  0  0  0\r\n   -4.5121   -0.6395    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -5.3325   -0.5532    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\r\n   -3.6146   -2.1938    0.0000 Cl  0  0  0  0  0  0  0  0  0  0  0  0\r\n   -1.8590   -1.8207    0.0000 Cl  0  0  0  0  0  0  0  0  0  0  0  0\r\n  1  2  1  0      \r\n  2  3  1  0      \r\n  3  4  2  0      \r\n  3  5  1  0      \r\n  5  6  4  0      \r\n  6  7  4  0      \r\n  7  8  4  0      \r\n  8  9  4  0      \r\n  5  9  4  0      \r\n  8 10  1  0      \r\n 10 11  1  0      \r\n 11 12  1  0      \r\n 12 13  1  0      \r\n 13 14  1  0      \r\n 14 15  1  0      \r\n 10 15  1  0      \r\n 13 16  1  0      \r\n 16 17  1  0      \r\n 17 18  2  0      \r\n 17 19  1  0      \r\n 19 20  4  0      \r\n 20 21  4  0      \r\n 21 22  4  0      \r\n 22 23  4  0      \r\n 19 23  4  0      \r\n 22 24  1  0      \r\n 24 25  3  0      \r\n 21 26  1  0      \r\n 20 27  1  0      \r\nM  END\r\n"},"mmpdbDatabasePath":{"id":"mmpdbDatabasePath","dataType":"string","contentType":null,"selectorType":null,"data":"C:\\db\\mmp\\AID_1341_datatable_all.mmpdb"}},"maximumOutputColumns":10,"maximumOutputTables":1,"resultTables":null,"serviceUri":"glysade.python","inputColumns":{},"webServiceRequest":null,"requestId":-1,"tkid":null,"script":null,"updateBehavior":"automatic","allowedClients":["Analyst","WebPlayer"],"limitBy":"none","ironPython":"############################################\n#  Copyright 2020 Glysade LLC             #\n############################################\n\nimport sys, clr, json\nfrom System import Guid, String\nfrom Spotfire.Dxp.Data import DataTable, DataManager\nfrom Spotfire.Dxp.Application import PanelTypeIdentifiers\nfrom Spotfire.Dxp.Application import Panel\nfrom Spotfire.Dxp.Application.Layout import LayoutDefinition\nimport Spotfire.Dxp.Application.PanelCollection\n\nfrom System import AppDomain\nfor asm in AppDomain.CurrentDomain.GetAssemblies():\n  if asm.GetName().Name == 'Charts' or asm.GetName().Name == 'Common':\n      clr.AddReference(asm.FullName)\n\nfrom Common import ColumnIdService\nfrom Charts import ChartsModel\n\n#tableId pass in args\ndataTable = None\n\ntableGuid = Guid(tableId)\nif Document.Data.Tables.Contains(tableGuid):\n  dataTable = Document.Data.Tables[tableGuid]\n\nif not dataTable:\n    raise Exception('target table not found')\n\nidService = Application.GetService(ColumnIdService)\n\npage = Document.Pages.AddNew('MMP Search Results')\n\ntableVis = page.Visuals.AddNew[ChartsModel]()\ntableVis.SetKeyValue('visualization','table-visualization')\ntableVis.DataTable = dataTable\ntableVis.ConfigureColumns()\ntableVis.Title = 'MMP Results'\ntableVis.Marking = Document.Data.Markings.DefaultMarkingReference\ntableVis.SetKeyValue(tableId+\".table-visualization.table.transposed\",\"true\")\nskipColumns = ['Query','ENV_RULE','Fingerprint','TransformFingerprint']\nremoved = []\nunfixed = []\nfor column in dataTable.Columns:\n    if column.Name in skipColumns:\n        removed.append(idService.GetID(column))\n    else:\n        unfixed.append(idService.GetID(column))\n\ntableVis.SetKeyValue(tableId+\".table-visualization.table.removedColumnIds\", json.dumps(removed))\ntableVis.SetKeyValue(tableId+\".table-visualization.table.unfixedColumnIds\", json.dumps(unfixed))\n\nmmpFilterVis = page.Visuals.AddNew[ChartsModel]()\nmmpFilterVis.SetKeyValue('visualization','mmp-filter-visualization')\nmmpFilterVis.DataTable = dataTable\nmmpFilterVis.ConfigureColumns()\nmmpFilterVis.Title = 'MMP Filter'\nmmpFilterVis.Marking = Document.Data.Markings.DefaultMarkingReference\nmmpFilterVis.SetKeyValue('mmp-filter-visualization.filter.mmp-results-visualization',tableVis.Visual.Id.ToString())\n\nmpoVis = page.Visuals.AddNew[ChartsModel]()\nmpoVis.SetKeyValue('visualization','mpo-visualization')\nmpoVis.DataTable = dataTable\nmpoVis.ConfigureColumns()\nmpoVis.Title = 'MMP Properties'\nmpoVis.Marking = Document.Data.Markings.DefaultMarkingReference\nskipColumns = ['RADIUS','ENV_RULE']\nconfigured = []\nfor column in dataTable.Columns:\n    if column.DataType.IsNumeric and column.Name not in skipColumns:\n        configured.append({'columnId': idService.GetID(column),'logScale':False,'inverted':False})\nmpoVis.SetKeyValue(tableId+\".mpo-visualization.mpo.axes\",json.dumps(configured))\n\ntableVis.SetActiveVisual()\npage.AutoConfigure()\n\npage.FilterPanel.Visible = True\npage.DetailsOnDemandPanel.Visible = False\n\nfilterPanel = page.FilterPanel\nfor group in filterPanel.TableGroups:\n   if group.Name != dataTable.Name:\n    group.Visible = False\n\nlayout = LayoutDefinition()\nlayout.BeginStackedSection()\nlayout.BeginSideBySideSection()\nlayout.Add(mmpFilterVis.Visual,33.3)\nlayout.Add(mpoVis.Visual,66.6)\nlayout.EndSection()\nlayout.Add(tableVis.Visual)\nlayout.EndSection()\npage.ApplyLayout(layout)\n","chartsFxnType":null,"chartsRequest":null}